**002.INITIATIVE-CPL-kv-kv-pe-vm-§32.md**  
**Scope:** production-only  

_Implements the Azure built-in Key Vault network hardening policies; assumes the application layer restricts access to approved compute identities._  

My custom policy (for VM) enforces that the VM must always have a Managed Identity (MI)  
+  
two Azure built-in policies block any Key Vault without a PE or with public access enabled  


# WHAT

initiative removes Internet exposure - enforces isolation within the VNet only and for the specified endpoints

# WHY

The Key Vault accessible from e.g., a VM only.
KV public network access disabled.
KV PE exists.
The ARTIFACT requires that the resource (e.g.VM) must have an MI for PE.

# RGPD
Article 32 (1)(b) — ensures confidentiality and integrity of data in transit and at rest by restricting exposure

# HOW
two default Azure policies:
i   “Key vaults should use private endpoints”
ii  “Key Vault should disable public network access”


{
  "if": {
    "allOf": [
      { "field": "type", "equals": "Microsoft.KeyVault/vaults" },
      {
        "anyOf": [
          { "field": "Microsoft.KeyVault/vaults/publicNetworkAccess", "notEquals": "Disabled" },
          { "count": { "field": "Microsoft.KeyVault/vaults/privateEndpointConnections[*]" }, "equals": 0 }
        ]
      }
    ]
  },
  "then": { "effect": "deny" }
}
