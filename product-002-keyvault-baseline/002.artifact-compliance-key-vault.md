[return to main page](../README.md)

# Product 2 - Key Vault Resilience & Isolation Baseline:
Chroni KV przed utrata sekretów i przed dostepem z internetu

> **Business value:**<br>Mniejsze ryzyko utraty kluczy / sekretów.<br>Mocny argument w audycie: retencja + odporność dokumentowane polityką.


# Artifacts content: 
- soft delete + purge protection + 90 dni retention
- private endpoint only, public network access disabled
- wymagany Managed Identity po stronie VM / App Service


# Artefact implements GDPR Articles 5 and 32.

- Article 32 – Security of processing
- Article 5(1)(e) – Storage limitation (personal data shall be kept no longer than necessary but long enough for accountability)


# tdd
az keyvault list --query "[].{name:name,rg:resourceGroup}" -o tsv |
ForEach-Object {
$p = $_ -split "`t"
$o = az keyvault show -n $p[0] -g $p[1] -o json | ConvertFrom-Json
$ret = $o.properties.softDeleteRetentionInDays; if ($null -eq $ret) {$ret = 0}
[pscustomobject]@{
Name=$o.name; SoftDelete=[bool]$o.properties.enableSoftDelete
PurgeProtection=[bool]$o.properties.enablePurgeProtection
RetentionDays=[int]$ret
Compliant=($o.properties.enableSoftDelete -and $o.properties.enablePurgeProtection -and $ret -eq 90)
}
} | Sort-Object Compliant, Name | Format-Table -AutoSize


[go to next module](../product-003-networking-baseline/003-artifact-compliance-networking.md)